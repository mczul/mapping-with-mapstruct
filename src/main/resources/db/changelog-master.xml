<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.4.xsd">

    <changeSet id="setup" author="c.zuleger@cronos.de">
        <createTable tableName="customer">
            <column name="id" type="uuid" defaultValue="random_uuid()">
                <constraints nullable="false"/>
            </column>
            <column name="email" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="first_name" type="varchar(80)">
                <constraints nullable="false"/>
            </column>
            <column name="last_name" type="varchar(80)">
                <constraints nullable="false"/>
            </column>
            <column name="birthday" type="date"/>
            <column name="created" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified" type="timestamp">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addPrimaryKey tableName="customer" columnNames="id"/>
        <addUniqueConstraint constraintName="un_customer_email" tableName="customer"
                             columnNames="email"/>

        <insert tableName="customer">
            <column name="id">9a42fcb7-e49c-401e-b7c6-e5c9960c95fb</column>
            <column name="email">c.zuleger@cronos.de</column>
            <column name="first_name">Christoph</column>
            <column name="last_name">Zuleger</column>
            <column name="birthday">1979-07-31</column>
            <column name="created">2022-08-15T12:34:56Z</column>
            <column name="last_modified">2022-08-15T12:34:56Z</column>
        </insert>

        <createTable tableName="customer_order">
            <column name="id" type="uuid" defaultValue="random_uuid()">
                <constraints nullable="false"/>
            </column>
            <column name="customer_id" type="uuid">
                <constraints nullable="false"/>
            </column>
            <column name="article_name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="article_quantity" type="integer">
                <constraints nullable="false"/>
            </column>
            <column name="state" type="varchar(80)">
                <constraints nullable="false"/>
            </column>
            <column name="created" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified" type="timestamp">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addPrimaryKey tableName="customer_order" columnNames="id"/>
        <addForeignKeyConstraint constraintName="fk_order_customer"
                                 baseTableName="customer_order"
                                 baseColumnNames="customer_id"
                                 referencedTableName="customer"
                                 referencedColumnNames="id"/>

        <insert tableName="customer_order">
            <column name="customer_id">9a42fcb7-e49c-401e-b7c6-e5c9960c95fb</column>
            <column name="state">NEW</column>
            <column name="article_name">Tomato</column>
            <column name="article_quantity">12</column>
            <column name="created">2022-01-02T12:34:56Z</column>
            <column name="last_modified">2022-01-02T12:34:56Z</column>
        </insert>

        <insert tableName="customer_order">
            <column name="customer_id">9a42fcb7-e49c-401e-b7c6-e5c9960c95fb</column>
            <column name="state">ACCEPTED</column>
            <column name="article_name">Tomato</column>
            <column name="article_quantity">23</column>
            <column name="created">2022-02-03T12:34:56Z</column>
            <column name="last_modified">2022-04-05T12:34:56Z</column>
        </insert>

        <insert tableName="customer_order">
            <column name="customer_id">9a42fcb7-e49c-401e-b7c6-e5c9960c95fb</column>
            <column name="state">IN_PROGRESS</column>
            <column name="article_name">Olive</column>
            <column name="article_quantity">4711</column>
            <column name="created">2022-06-07T12:34:56Z</column>
            <column name="last_modified">2022-08-09T12:34:56Z</column>
        </insert>

        <insert tableName="customer_order">
            <column name="customer_id">9a42fcb7-e49c-401e-b7c6-e5c9960c95fb</column>
            <column name="state">SUCCESS</column>
            <column name="article_name">Mozarella</column>
            <column name="article_quantity">10</column>
            <column name="created">2022-10-11T12:34:56Z</column>
            <column name="last_modified">2022-12-13T12:34:56Z</column>
        </insert>

    </changeSet>

</databaseChangeLog>
